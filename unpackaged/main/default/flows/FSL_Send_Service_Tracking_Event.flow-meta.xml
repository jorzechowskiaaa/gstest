<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>59.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Set_Service_Tracking_Platform_Event_Data</name>
        <label>Set Service Tracking Platform Event Data</label>
        <locationX>176</locationX>
        <locationY>323</locationY>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.SourceSystem_Id__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>240</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.SourceSystem_OrgCode__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ServiceAppointment.Work_Order__r.Call_Origin_OrgCode__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.SourceSystem_OrgName__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ServiceAppointment.Work_Order__r.Call_Origin_OrgName__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.D3_CallKey__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ServiceAppointment.Work_Order__r.External_Id__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.D3_CallDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ServiceAppointment.Work_Order__r.Call_Date__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.D3_CallId__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ServiceAppointment.Work_Order__r.Call_Id__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.EventTime__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.BL_TrackingUrl__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.BL_TrackingId__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.TD_TrackingId__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.TD_TrackingUrl__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.Tracking_System__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Appointment Assistant</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.WorkOrder_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>En Route</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.Tracking_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>BREAKDOWN_LOCATION</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.Tracking_Url__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ApptAssistUrl</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ServiceTrackingEvent.WorkOrder_CallType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>DRR</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Publish_Service_Tracking_Platform_Event</targetReference>
        </connector>
    </assignments>
    <environments>Default</environments>
    <formulas>
        <name>ApptAssistUrl</name>
        <dataType>String</dataType>
        <expression>LEFT({!$Record.ApptAssistantInfoUrl}, 255)</expression>
    </formulas>
    <interviewLabel>FSL Send Service Tracking Event {!$Flow.CurrentDateTime}</interviewLabel>
    <label>FSL Send Service Tracking Event</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Publish_Service_Tracking_Platform_Event</name>
        <label>Publish Service Tracking Platform Event</label>
        <locationX>176</locationX>
        <locationY>431</locationY>
        <inputReference>var_ServiceTrackingEvent</inputReference>
    </recordCreates>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Set_Service_Tracking_Platform_Event_Data</targetReference>
        </connector>
        <filterFormula>(ISCHANGED({!$Record.LocationStatus})&amp;&amp;TEXT({!$Record.LocationStatus})=&#39;EnRoute&#39;) &amp;&amp;({!$Record.ServiceAppointment.Work_Order__r.Call_Type__c}=&#39;DRR&#39; || {!$Record.ServiceAppointment.Work_Order__r.Call_Type__c}=&#39;RAP&#39;)</filterFormula>
        <object>AssignedResource</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <description>This is not used for anything, it&#39;s just so it won&#39;t break</description>
        <name>DummyResource</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>var_CaptivatedEvent</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Captivated_Event__e</objectType>
    </variables>
    <variables>
        <name>var_ServiceTrackingEvent</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Service_Tracking__e</objectType>
    </variables>
    <variables>
        <name>var_Vehicle_TruckId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
